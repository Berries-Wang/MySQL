# 线上数据统计： 参与活动时是非会员数量
> 即，在同一张表中对某一个维度进行分组，再计算每组数据中的极值

## 背景
&nbsp;&nbsp;线上活动已结束，需要统计有多少参与活动的买家在进入时是非会员身份，从而统计入会率。

## 解决方案
&nbsp;&nbsp;先查询最早进入活动的日志ID，再判断是否是会员.

&nbsp;&nbsp;表结构如下:
```sql
   # 打点数据表
   CREATE TABLE `activity_log_data_info` (
      `id` bigint(20) NOT NULL AUTO_INCREMENT COMMENT '自增主键',
      `gmt_created` datetime NOT NULL COMMENT '创建时间',
      `gmt_modified` datetime NOT NULL COMMENT '更新时间',
      `open_id` varchar(64) DEFAULT NULL COMMENT '卖家openId',
      `activity_id` varchar(64) NOT NULL COMMENT '活动ID',
      `data_type` varchar(20) NOT NULL COMMENT '数据类型', # JOIN_MEM 表示是入会打点数据
      `ext_col_1` varchar(100) DEFAULT NULL COMMENT '拓展字段1', # IS MEM: 表示是会员;NOT MEM:不是会员;
      `buyer_open_id` varchar(64) NOT NULL COMMENT '买家',
      PRIMARY KEY (`id`),
      KEY `idx_buyer_activity` (`group_id`,`activity_id`,`buyer_open_id`)
) ENGINE=InnoDB AUTO_INCREMENT=1 DEFAULT CHARSET=utf8mb4;
```



