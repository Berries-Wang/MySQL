# Full-Text Searches with Query Expansion
```txt
   拓展查询
   
```

Full-text search supports query expansion (and in particular, its variant “blind query expansion”). This is generally useful when a search phrase is too short, which often means that the user is relying on implied knowledge that the full-text search engine lacks. For example, a user searching for “database” may really mean that “MySQL”, “Oracle”, “DB2”, and “RDBMS” all are phrases that should match “databases” and should be returned, too. This is implied knowledge.(全文搜索支持查询扩展(特别是它的变体“盲查询扩展”)。当搜索短语太短时，这通常很有用，这通常意味着用户依赖于全文搜索引擎所缺乏的隐含知识。例如，搜索“database”的用户实际上可能意味着“MySQL”、“Oracle”、“DB2”和“RDBMS”都是应该匹配“数据库”的短语，也应该返回。这是隐含知识。)

Blind query expansion (also known as automatic relevance feedback) is enabled by adding WITH QUERY EXPANSION or IN NATURAL LANGUAGE MODE WITH QUERY EXPANSION following the search phrase. It works by performing the search twice, where the search phrase for the second search is the original search phrase concatenated with the few most highly relevant documents from the first search. Thus, if one of these documents contains the word “databases” and the word “MySQL”, the second search finds the documents that contain the word “MySQL” even if they do not contain the word “database”. The following example shows this difference:(盲查询扩展(也称为自动关联反馈)可以通过在搜索短语后面添加WITH query expansion或IN NATURAL LANGUAGE MODE WITH query expansion来实现。它通过执行两次搜索来工作，其中第二次搜索的搜索短语是原始搜索短语与第一次搜索中最相关的几个文档的连接。因此，如果其中一个文档包含单词“数据库”和单词“MySQL”，那么第二次搜索将找到包含单词“MySQL”的文档，即使它们不包含单词“数据库”。下面的例子显示了这种差异:)
```sql
   mysql> show create table articles\G
   *************************** 1. row ***************************
          Table: articles
   Create Table: CREATE TABLE `articles` (
     `id` int(10) unsigned NOT NULL AUTO_INCREMENT,
     `title` varchar(200) DEFAULT NULL,
     `body` text,
     PRIMARY KEY (`id`),
     FULLTEXT KEY `title` (`title`,`body`)
   ) ENGINE=InnoDB AUTO_INCREMENT=10 DEFAULT CHARSET=latin1
   1 row in set (0.00 sec)

  # 自然语言模式
  mysql> SELECT * FROM articles WHERE MATCH (title,body) AGAINST ('database' IN NATURAL LANGUAGE MODE);
  +----+------------------------------+-------------------------------+
  | id | title                        | body                          |
  +----+------------------------------+-------------------------------+
  |  6 | Database, Database, Database | database database database    |
  |  3 | Optimizing Your Database     | In this database tutorial ... |
  |  1 | MySQL Tutorial               | This database tutorial ...    |
  +----+------------------------------+-------------------------------+
  3 rows in set (0.01 sec)

  # 查询拓展模式
  mysql>  SELECT * FROM articles WHERE MATCH (title,body) AGAINST ('database' WITH QUERY EXPANSION);
  +----+------------------------------+-------------------------------------+
  | id | title                        | body                                |
  +----+------------------------------+-------------------------------------+
  |  3 | Optimizing Your Database     | In this database tutorial ...       |
  |  6 | Database, Database, Database | database database database          |
  |  1 | MySQL Tutorial               | This database tutorial ...          |
  |  5 | MySQL Security               | When configured properly, MySQL ... |
  |  8 | MySQL Full-Text Indexes      | MySQL fulltext indexes use a ..     |
  |  2 | How To Use MySQL             | After you went through a ...        |
  |  4 | MySQL vs. YourSQL            | When comparing databases ...        |
  |  7 | 1001 MySQL Tricks            | 1. Never run mysqld as root. 2. ... |
  +----+------------------------------+-------------------------------------+
  8 rows in set (0.00 sec)

  mysql> insert into articles(title,body) values('cool','so cool');
  Query OK, 1 row affected (0.00 sec)
  
  mysql>  SELECT * FROM articles WHERE MATCH (title,body) AGAINST ('database' WITH QUERY EXPANSION);
  +----+------------------------------+-------------------------------------+
  | id | title                        | body                                |
  +----+------------------------------+-------------------------------------+
  |  3 | Optimizing Your Database     | In this database tutorial ...       |
  |  6 | Database, Database, Database | database database database          |
  |  1 | MySQL Tutorial               | This database tutorial ...          |
  |  5 | MySQL Security               | When configured properly, MySQL ... |
  |  8 | MySQL Full-Text Indexes      | MySQL fulltext indexes use a ..     |
  |  2 | How To Use MySQL             | After you went through a ...        |
  |  4 | MySQL vs. YourSQL            | When comparing databases ...        |
  |  7 | 1001 MySQL Tricks            | 1. Never run mysqld as root. 2. ... |
  +----+------------------------------+-------------------------------------+
  8 rows in set (0.01 sec)

```


## 参考资料
1. [Full-Text Searches with Query Expansion](https://dev.mysql.com/doc/refman/8.0/en/fulltext-query-expansion.html)