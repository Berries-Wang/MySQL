#  The System Tablespace
The system tablespace is the storage area for the change buffer. It may also contain table and index data if tables are created in the system tablespace rather than file-per-table or general tablespaces. In previous MySQL versions, the system tablespace contained the InnoDB data dictionary. In MySQL 8.0, InnoDB stores metadata in the MySQL data dictionary. See Chapter 16, MySQL Data Dictionary. In previous MySQL releases, the system tablespace also contained the doublewrite buffer storage area. This storage area resides in separate doublewrite files as of MySQL 8.0.20. See Section 17.6.4, “Doublewrite Buffer”.(system tablespace是存储change buffer的存储区域。如果在系统表空间创建的表，而不是在General table space 或　file-per-table表空间创建的表，则他还可能包含表和索引的数据。在以前的MySQL版本中<sup>本文档是参考MySQL8.0文档</sup>,system tablespace表空间包含InnoDB数据字典。在MySQL8.0中，InnoDB讲元数据存储在MySQL数据字典中。在以前的MySQL版本中，system tablespace 表空间也包含double write buffer存储区域。从MySQL8.0开始，这个存储区域位于单独的double write文件中)

The system tablespace can have one or more data files. By default, a single system tablespace data file, named ibdata1, is created in the data directory. The size and number of system tablespace data files is defined by the innodb_data_file_path startup option. For configuration information, see System Tablespace Data File Configuration.(系统表空间可以包含一个或多个数据文件。默认情况下，在data目录中创建一个系统表空间数据文件ibdata1。系统表空间数据文件的大小和数量由innodb_data_file_path启动选项定义。)

## Resizing the System Tablespace
### Increasing the Size of the System Tablespace
The easiest way to increase the size of the system tablespace is to configure it to be auto-extending. To do so, specify the autoextend attribute for the last data file in the innodb_data_file_path setting, and restart the server. For example:(增加系统表空间大小的最简单方法是将其配置为自动扩展。为此，在innodb_data_file_path设置中为最后一个数据文件指定autoextend属性，然后重新启动服务器。例如:)
```txt
     innodb_data_file_path=ibdata1:10M:autoextend
```

When the autoextend attribute is specified, the data file automatically increases in size by 8MB increments as space is required. The innodb_autoextend_increment variable controls the increment size.(当指定autoextend属性时，数据文件的大小会根据空间需求自动增加8MB。变量innodb_autoextend_increment控制增量的大小。)

You can also increase system tablespace size by adding another data file. To do so:
1. Stop the MySQL server.
2. If the last data file in the innodb_data_file_path setting is defined with the autoextend attribute, remove it, and modify the size attribute to reflect the current data file size. To determine the appropriate data file size to specify, check your file system for the file size, and round that value down to the closest MB value, where a MB is equal to 1024 x 1024 bytes.(如果innodb_data_file_path设置中的最后一个数据文件使用autoextend属性定义，则删除该属性，并修改size属性以反映当前数据文件的大小。要确定要指定的适当数据文件大小，请检查文件系统中的文件大小，并将该值四舍五入到最接近的MB值，其中MB等于1024 x 1024字节。)
3. Append a new data file to the innodb_data_file_path setting, optionally specifying the autoextend attribute. The autoextend attribute can be specified only for the last data file in the innodb_data_file_path setting.(向innodb_data_file_path设置追加一个新的数据文件，可选择指定autoextend属性。autoextend属性只能为innodb_data_file_path设置中的最后一个数据文件指定。)
4. Start the MySQL server.

For example, this tablespace has one auto-extending data file:
```txt
   innodb_data_home_dir =
   innodb_data_file_path = /ibdata/ibdata1:10M:autoextend
```

Suppose that the data file has grown to 988MB over time. This is the innodb_data_file_path setting after modifying the size attribute to reflect the current data file size, and after specifying a new 50MB auto-extending data file:(假设数据文件随着时间的推移已经增长到988MB。这是innodb_data_file_path在修改size属性以反映当前数据文件大小后的设置，并指定了一个新的50MB自动扩展数据文件:)
```txt
    innodb_data_home_dir =
    innodb_data_file_path = /ibdata/ibdata1:988M;/disk2/ibdata2:50M:autoextend
```

When adding a new data file, do not specify an existing file name. InnoDB creates and initializes the new data file when you start the server.


## Decreasing the Size of the InnoDB System Tablespace
Decreasing the size of an existing system tablespace is not supported. The only option to achieve a smaller system tablespace is to restore your data from a backup to a new MySQL instance created with the desired system tablespace size configuration.（不支持减小现有系统表空间的大小。实现更小的系统表空间的唯一选择是将数据从备份恢复到使用所需的系统表空间大小配置创建的新MySQL实例。）

To avoid a large system tablespace, consider using file-per-table tablespaces or general tablespaces for your data. File-per-table tablespaces are the default tablespace type and are used implicitly when creating an InnoDB table. Unlike the system tablespace, file-per-table tablespaces return disk space to the operating system when they are truncated or dropped. For more information, General tablespaces are multi-table tablespaces that can also be used as an alternative to the system tablespace. （为了避免使用大型系统表空间，请考虑为数据使用file-per-table表空间或General表空间。file-per-table表空间是默认的表空间类型，在创建InnoDB表时隐式使用。与系统表空间不同，每个表文件的表空间在被截断或删除时将磁盘空间返回给操作系统。要了解更多信息，请参见17.6.3.2节“逐表表空间文件”。一般的表空间是多表空间，也可以用作系统表空间的替代方案。）

## Using Raw Disk Partitions for the System Tablespace
Raw disk partitions can be used as system tablespace data files. This technique enables nonbuffered I/O on Windows and some Linux and Unix systems without file system overhead. Perform tests with and without raw partitions to verify whether they improve performance on your system.(裸磁盘分区可以作为系统表空间数据文件。这种技术允许在Windows和一些Linux和Unix系统上使用非缓冲I/O，而没有文件系统开销。执行使用和不使用原始分区的测试，以验证它们是否提高了系统的性能。)

When using a raw disk partition, ensure that the user ID that runs the MySQL server has read and write privileges for that partition. For example, if running the server as the mysql user, the partition must be readable and writeable by mysql. If running the server with the --memlock option, the server must be run as root, so the partition must be readable and writeable by root.(当使用裸磁盘分区时，确保运行MySQL服务器的用户ID具有该分区的读写权限。例如，如果以mysql用户运行服务器，分区必须可以被mysql读写。如果使用——memlock选项运行服务器，服务器必须以root身份运行，因此分区必须是root可读和可写的。)

### Allocating a Raw Disk Partition on Linux and Unix Systems
1. To use a raw device for a new server instance, first prepare the configuration file by setting innodb_data_file_path with the raw keyword. For example:
   ```txt
      [mysqld]
      innodb_data_home_dir=
      innodb_data_file_path=/dev/hdd1:3Graw;/dev/hdd2:2Graw
   ```
    The partition must be at least as large as the size that you specify. Note that 1MB in InnoDB is 1024 × 1024 bytes, whereas 1MB in disk specifications usually means 1,000,000 bytes.(分区必须至少与您指定的大小一样大。注意，InnoDB中的1MB是1024 × 1024字节，而磁盘规范中的1MB通常意味着1,000,000字节。)
2. Then initialize the server for the first time by using --initialize or --initialize-insecure. InnoDB notices the raw keyword and initializes the new partition, and then it stops the server.
3. Now restart the server. InnoDB now permits changes to be made.

### Allocating a Raw Disk Partition on Windows
1. On Windows systems, the same steps and accompanying guidelines described for Linux and Unix systems apply except that the innodb_data_file_path setting differs slightly on Windows. For example:
   ```txt
      [mysqld]
      innodb_data_home_dir=
      innodb_data_file_path=//./D::10Graw
   ```
   The //./ corresponds to the Windows syntax of \\.\ for accessing physical drives. In the example above, D: is the drive letter of the partition.


## 参考资料
1. [The System Tablespace](https://dev.mysql.com/doc/refman/8.0/en/innodb-system-tablespace.html)