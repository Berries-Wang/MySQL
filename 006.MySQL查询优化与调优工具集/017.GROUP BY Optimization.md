# GROUP BY Optimization
&nbsp;&nbsp;The most general way to satisfy a GROUP BY clause is to scan the whole table and create a new temporary table where all rows from each group are consecutive, and then use this temporary table to discover groups and apply aggregate functions (if any). In some cases, MySQL is able to do much better than that and avoid creation of temporary tables by using index access.(满足GROUP BY子句的最常见方法是扫描整个表并创建一个新的临时表，其中每个组的所有行都是连续的，然后使用这个临时表来发现组并应用聚合函数(如果有的话)。在某些情况下，MySQL可以做得更好，通过使用索引访问来避免创建临时表。)

&nbsp;&nbsp;The most important preconditions for using indexes for GROUP BY are that all GROUP BY columns reference attributes from the same index, and that the index stores its keys in order (as is true, for example, for a BTREE index, but not for a HASH index). Whether use of temporary tables can be replaced by index access also depends on which parts of an index are used in a query, the conditions specified for these parts, and the selected aggregate functions.(GROUP BY 使用索引最重要的前提条件是所有GROUP BY列都引用同一个索引中的字段，并且索引中的字段是按照顺序存储(例如，对于BTREE索引是这样，但对于HASH索引则不是)。是否可以用索引访问代替临时表的使用，还取决于查询中使用了索引的哪些部分、为这些部分指定的条件以及所选的聚集函数。)

&nbsp;&nbsp;There are two ways to execute a GROUP BY query through index access, as detailed in the following sections. The first method applies the grouping operation together with all range predicates (if any). The second method first performs a range scan, and then groups the resulting tuples.(GROUP BY 查询有两种使用索引的方法，第一种方法将分组操作与所有范围谓词(如果有的话)一起应用。第二种方法首先执行范围扫描，然后对结果元组进行分组。)

## GROUP BY 查询使用索引场景方式一： Loose Index Scan
&nbsp;&nbsp;The most efficient way to process GROUP BY is when an index is used to directly retrieve the grouping columns.  With this access method, MySQL uses the property of some index types that the keys are ordered (for example, BTREE).  This property enables use of lookup groups in an index without having to consider all keys in the index that satisfy all WHERE conditions.  This access method considers only a fraction of the keys in an index, so it is called a Loose Index Scan.  When there is no WHERE clause, a Loose Index Scan reads as many keys as the number of groups, which may be a much smaller number than that of all keys.  If the WHERE clause contains range predicates (see the discussion of the range join type in Section 8.8.1, “Optimizing Queries with EXPLAIN”), a Loose Index Scan looks up the first key of each group that satisfies the range conditions, and again reads the smallest possible number of keys.  This is possible under the following conditions:(处理GROUP BY的最有效方法是使用索引直接检索分组列。使用这种访问方法，MySQL要求索引是有序的(例如BTREE)。这个属性允许在索引中使用查找组，而不必考虑索引中满足所有WHERE条件的所有键。这种访问方法只考虑索引中的一小部分键，因此称为松散索引扫描(Loose index Scan)。当没有WHERE子句时，松散索引扫描读取的键数目与组的数目相同，这可能比所有键的数目小得多。如果WHERE子句包含范围谓词，松散索引扫描将查找满足范围条件的每组的第一个键，并再次读取尽可能少的键。这在以下情况下是可能的:)
## GROUP BY 查询使用索引场景方式二： Tight Index Scan